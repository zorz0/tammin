{"version":3,"sources":["_login.js"],"names":["l","Ladda","create","document","querySelector","input","value","slice","length","maxLength","encryptCredentials","key","CryptoJS","enc","Utf8","parse","enky","iv","val","txtpassword","AES","encrypt","txtUserName","encryptedemail","keySize","mode","CBC","padding","Pkcs7","$","encryptedpassword","pad","getCaptcha","ajax","base64Data","url","dataURL","type","success","log","data","status","attr","token","error","xhr","LoginOTPRedirection","traditional","otpURL","dataType","setTimeout","hide","html","show","focus","click","modal","window","location","validateMobileURL","on","e","pastedValue","originalEvent","clipboardData","getData","isNaN","preventDefault","this","trimTheText","toLowerCase","submit","evt","is","passwordIsRequired","isLoginWithHomePageFlow","start","$form","valid","controllerurl","prop","formText","serialize","OK","Error","stop","captchaNotValid","removeItem","cookie","isHybridAppUserAgent","updateFcmTokenFromWeb","NavigateUrl","href","localStorage","errors","addClass","find","filter","each","jQuery","resetValidation","closest","validate","resetForm","removeClass","rules","empty","ready","strError","BackdropiconShow","bind","ConvertToLowerWithKeyCode"],"mappings":"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","file":"_login.min.js","sourcesContent":["var l = Ladda.create(document.querySelector('#btnLoginHeader'));\r\n$(\"#btnLoginHeader\").click(function () {\r\n    $(\"#LoginErrorMessage\").hide();\r\n});\r\n\r\n$(\"#forgetPasswordDiv\").click(function () {\r\n    $(\"#login-popup\").modal('hide');\r\n    window.location.href = validateMobileURL;\r\n});\r\n\r\n$('#loginIdentityNumber').on('paste', function (e) {\r\n    var clipboardData = e.originalEvent.clipboardData || window.clipboardData;\r\n    var pastedValue = clipboardData.getData('text');\r\n\r\n    if (isNaN(pastedValue)) {\r\n        e.preventDefault();\r\n        $(this).val('');\r\n    }\r\n});\r\n\r\n$(\"#login-email\").focusout(function () {\r\n    $(this).trimTheText();\r\n    $(this).val(($(this).val()).toLowerCase());\r\n});\r\n\r\nfunction checkInputLength(input) {\r\n    if (input.value < 0 || input.value == '') {\r\n        input.value = input.value.slice(1);\r\n    }\r\n    var maxLength = 4;\r\n    if (input.value.length > maxLength) {\r\n        input.value = input.value.slice(0, maxLength); // Truncate the value to the maximum length\r\n    }\r\n}\r\nfunction encryptCredentials() {\r\n    var key = CryptoJS.enc.Utf8.parse(enky);\r\n    var iv = CryptoJS.enc.Utf8.parse(enky);\r\n    var txtUserName = $(\"#login-email\").val();\r\n    var txtpassword = $(\"#login-password\").val();\r\n\r\n    var encryptedemail = CryptoJS.AES.encrypt(CryptoJS.enc.Utf8.parse(txtUserName), key,\r\n        {\r\n            keySize: 128 / 8,\r\n            iv: iv,\r\n            mode: CryptoJS.mode.CBC,\r\n            padding: CryptoJS.pad.Pkcs7\r\n        });\r\n\r\n    $(\"#EncEl\").val(encryptedemail);\r\n\r\n    var encryptedpassword = CryptoJS.AES.encrypt(CryptoJS.enc.Utf8.parse(txtpassword), key,\r\n        {\r\n            keySize: 128 / 8,\r\n            iv: iv,\r\n            mode: CryptoJS.mode.CBC,\r\n            padding: CryptoJS.pad.Pkcs7\r\n        });\r\n\r\n    $(\"#EncPS\").val(encryptedpassword);\r\n}\r\n\r\n$(function () {\r\n    //getCaptcha();\r\n\r\n    $('#frmLogin').submit(function (evt) {\r\n\r\n        $(\"#SchemeCaptchaErrorMessage\").hide();\r\n        $(\"#SchemeCaptchaErrorMessage\").html('');\r\n        $('#passwordValidationError').hide();\r\n        $('#passwordValidationError').html('');\r\n        if ($('#passwordField').is(\":visible\") == false && $('#login-password').val() != '')\r\n            $('#login-password').val('');\r\n\r\n        if ($('#captchaCode').val() == '' && $('#passwordField').is(\":visible\") == false) {\r\n            $('#SchemeCaptchaErrorMessage').show();\r\n            $('#SchemeCaptchaErrorMessage').html(captchaRequired);\r\n            evt.preventDefault();\r\n            return 0;\r\n        }\r\n        if ($('#passwordField').is(\":visible\") == true && $('#login-password').val() == '') {\r\n            $('#passwordValidationError').show();\r\n            $('#passwordValidationError').html(passwordIsRequired);\r\n            evt.preventDefault();\r\n            return 0;\r\n        }\r\n        if ($(\"#loginIdentityNumber\").val() == '')\r\n            return;\r\n        var isLoginWithHomePageFlow = false;\r\n        l.start();\r\n\r\n        $(\"#LoginErrorMessage\").hide();\r\n        $(\"#LoginErrorMessage\").html('');\r\n\r\n        evt.preventDefault();\r\n        var $form = $(this);\r\n        if ($(this).valid()) {\r\n            $(\"#PolicyHolderUniqueId\").prop(\"disabled\", true);\r\n            //if ($('#passwordField').is(\":visible\") == true)\r\n            //    $('#login-password').val('');\r\n\r\n            var formText = $form.serialize();\r\n            $(\"#PolicyHolderUniqueId\").prop(\"disabled\", false);\r\n            $.ajax({\r\n                type: \"POST\",\r\n                url: controllerurl,\r\n                data: formText + \"&IdentityNumber=\" + $(\"#loginIdentityNumber\").val() + \"&CaptchaCode=\" + $(\"#captchaCode\").val() + \"&CaptchaToken=\" + $(\"#captchaToken\").val() + \"&CurrentPagelangauge=\" + $(\"#hdnCurrentPageLangauge\").val() + \"&isCaptcha=\" + true + \"&IsLoginWithHomePageFlow=\" + isLoginWithHomePageFlow,\r\n                dataType: \"json\",\r\n                traditional: true,\r\n                success: function (data) {\r\n                    if (data.OK == \"Error\") {\r\n                        $(\"#LoginErrorMessage\").show();\r\n                        $(\"#LoginErrorMessage\").html(data.Error);\r\n                        try {\r\n                            //$($('.validation-summary-errors')[2]).show()\r\n                            //$($('.validation-summary-errors')[2]).html(data.Error);\r\n                            $($('.validation-summary-errors')[3]).show()\r\n                            $($('.validation-summary-errors')[3]).html(data.Error);\r\n                        }\r\n                        catch (e) { }\r\n                        getCaptcha();\r\n                        l.stop();\r\n                        return;\r\n                    }\r\n                    else if (data.OK == \"CaptchaNotValid\") {\r\n                        $('#SchemeCaptchaErrorMessage').show();\r\n                        $('#SchemeCaptchaErrorMessage').html(captchaNotValid);\r\n                        $(\"#LoginErrorMessage\").hide();\r\n                        $(\"#LoginErrorMessage\").html('');\r\n                        $(\"#captchaCode\").val('');\r\n                        try {\r\n                            $($('.validation-summary-errors')[2]).hide();\r\n                            $($('.validation-summary-errors')[2]).html('');\r\n                        }\r\n                        catch (e) { }\r\n                        l.stop();\r\n                        getCaptcha();\r\n                        return;\r\n                    }\r\n                    else if (data.OK == \"RedirectToValidateMobile\") {\r\n                        localStorage.removeItem(\"token\");\r\n                        document.cookie = \"JToken=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;\";\r\n                        document.cookie = \"JwtToken=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;\";\r\n                        localStorage.removeItem(\"logintimerCount\");\r\n                        localStorage.removeItem(\"loginotpRetrycount\");\r\n                        l.stop();\r\n                        if (isHybridAppUserAgent) {\r\n                            updateFcmTokenFromWeb();\r\n                        }\r\n                        window.location.href = data.NavigateUrl;\r\n                    }\r\n                    else if (data.OK == \"LoginOTPSuccess\") {\r\n                        if ($('#passwordField').is(\":visible\") == false) {\r\n                            validateMobileURL = data.NavigateUrl;\r\n                            $('#passwordField').show();\r\n                            $('#forgetPasswordDiv').show();\r\n                            $('#identityField').hide();\r\n                            $('#divSchemeCaptcha').hide();\r\n                            l.stop();\r\n                            return;\r\n                        }\r\n                        localStorage.removeItem(\"token\");\r\n                        document.cookie = \"JToken=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;\";\r\n                        document.cookie = \"JwtToken=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;\";\r\n                        localStorage.removeItem(\"logintimerCount\");\r\n                        localStorage.removeItem(\"loginotpRetrycount\");\r\n                        l.stop();\r\n                        if (isHybridAppUserAgent) {\r\n                            updateFcmTokenFromWeb();\r\n                        }\r\n                        window.location.href = data.NavigateUrl;\r\n                    }\r\n                    else {\r\n                        l.stop();\r\n                    }\r\n                },\r\n                errors: function (erro) {\r\n                    $(\"#LoginErrorMessage\").addClass(\"alert alert-error\");\r\n                    $(\"#LoginErrorMessage\").html(data.Error);\r\n                    $(\"#frmLogin\").find(\"#mathcaptcha\").html('');\r\n                    l.stop();\r\n                }\r\n            });\r\n        }\r\n        else {\r\n            $('#frmLogin *').filter(':input[type=text]').each(function () {\r\n                if ($(this).val() == '') {\r\n                    $(this).focus();\r\n                    return;\r\n                }\r\n            });\r\n        }\r\n    });\r\n});\r\nfunction getCaptcha() {\r\n    $.ajax({\r\n        url: '/api/V1/Captcha',\r\n        type: 'GET',\r\n        success: function (data) {\r\n            //$(\"#divSchemeCaptcha\").show();\r\n            var base64Data = data.image;\r\n            var dataURL = 'data:image/png;base64,' + base64Data;\r\n            $('#CaptchaImageForLogin').attr('src', dataURL);\r\n            $('#captchaToken').val(data.token);\r\n        },\r\n        error: function (xhr, status, error) {\r\n            console.log(error);\r\n        }\r\n    });\r\n}\r\n\r\n\r\nfunction LoginOTPRedirection(otpURL) {\r\n    $.ajax({\r\n        type: \"GET\",\r\n        url: otpURL,\r\n        //data: $form.serialize() + \"&CurrentPagelangauge=\" + $(\"#hdnCurrentPageLangauge\").val(),\r\n        dataType: \"html\",\r\n        traditional: true,\r\n        success: function (data) {\r\n            $('#signin-signup-content').hide();\r\n            $('#payment-login-content').hide();\r\n            $('#payment-signup-content').hide();\r\n            $('#payment-signup-otp').html(\"\");\r\n            $('#payment-signup-otp').html(data);\r\n            $('#payment-signup-otp').show();\r\n            setTimeout(function () {\r\n                $(\"#SMSCode\").focus();\r\n            }, 1000);\r\n        }\r\n    });\r\n}\r\n(function ($) {\r\n    //re-set all client validation given a jQuery selected form or child\r\n    $.fn.resetValidation = function () {\r\n\r\n        var $form = this.closest('form');\r\n\r\n        //reset jQuery Validate's internals\r\n        $form.validate().resetForm();\r\n\r\n        //reset unobtrusive validation summary, if it exists\r\n        $form.find(\"[data-valmsg-summary=true]\")\r\n            .removeClass(\"validation-summary-errors\")\r\n            .addClass(\"validation-summary-valid\")\r\n            .find(\"ul\").empty();\r\n\r\n        //reset unobtrusive field level, if it exists\r\n        $form.find(\"[data-valmsg-replace]\")\r\n            .removeClass(\"field-validation-error\")\r\n            .addClass(\"field-validation-valid\")\r\n            .empty();\r\n\r\n        return $form;\r\n    };\r\n})(jQuery);\r\n\r\n\r\n//focus on first element when Login modal open\r\n$('#login-popup').on('shown.bs.modal', function (e) {\r\n    $('#login-email').focus();\r\n    $(\"#login-email\").rules(\"remove\", \"required\");\r\n})\r\n\r\n$(document).ready(function () {\r\n    if (strError.toLowerCase() == \"true\") {\r\n        $(\"#login-popup\").modal('show');\r\n        $('#signup-content').hide();\r\n        $(\"#without-login\").hide();\r\n        $('#login-content').show();\r\n        BackdropiconShow();\r\n    }\r\n\r\n    $(\"#LoginErrorMessage\").hide();\r\n\r\n\r\n});\r\n\r\n$(\"#login-email\").bind('keyup', function (e) {\r\n    ConvertToLowerWithKeyCode(e);\r\n});\r\n\r\n"]}