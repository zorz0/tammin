"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function UET(v){this.stringExists=function(e){return e&&0<e.length},this.domain="bat.bing.com",this.domainCl="bat.bing.net",this.URLLENGTHLIMIT=4096,this.pageLoadEvt="pageLoad",this.customEvt="custom",this.pageViewEvt="page_view",v.Ver=void 0===v.Ver||"1"!==v.Ver&&1!==v.Ver?2:1,this.uetConfig={},this.uetConfig.consent={enabled:!1,adStorageAllowed:!0,adStorageUpdated:!1,hasWaited:!1,waitForUpdate:0},this.uetConfig.tcf={enabled:!1,vendorId:1126,hasLoaded:!1,timeoutId:null,gdprApplies:void 0,adStorageAllowed:void 0,measurementAllowed:void 0,personalizationAllowed:void 0},this.beaconParams={},this.supportsCORS=this.supportsXDR=!1,this.paramValidations={string_currency:{type:"regex",regex:/^[a-zA-Z]{3}$/,error:"{p} value must be ISO standard currency code"},number:{type:"num",digits:3,max:999999999999},integer:{type:"num",digits:0,max:999999999999},hct_los:{type:"num",digits:0,max:30},date:{type:"regex",regex:/^\d{4}-\d{2}-\d{2}$/,error:"{p} value must be in YYYY-MM-DD date format"},pid:{type:"pid"},enum:{type:"enum",error:"{p} value must be one of the allowed values"},array:{type:"array",error:"{p} must be an array with 1+ elements"},object:{type:"object",error:"{p} must be an object with 1+ elements"}},this.knownParams={event_action:{beacon:"ea"},event_category:{beacon:"ec"},event_label:{beacon:"el"},event_value:{type:"number",beacon:"ev"},page_title:{},page_location:{},page_path:{},ecomm_prodid:{beacon:"prodid"},ecomm_pagetype:{type:"enum",values:["home","searchresults","category","product","cart","purchase","other"],beacon:"pagetype"},ecomm_totalvalue:{type:"number"},ecomm_category:{},ecomm_query:{},ecomm_exp:{},hct_base_price:{type:"number"},hct_booking_xref:{},hct_checkin_date:{type:"date"},hct_checkout_date:{type:"date"},hct_length_of_stay:{type:"hct_los"},hct_partner_hotel_id:{},hct_total_price:{type:"number"},hct_pagetype:{type:"enum",values:["home","searchresults","offerdetail","conversionintent","conversion","property","cart","purchase","cancel","other"]},travel_destid:{},travel_originid:{},travel_pagetype:{type:"enum",values:["home","searchresults","offerdetail","conversionintent","conversion","cancel","other"]},travel_startdate:{type:"date"},travel_enddate:{type:"date"},travel_totalvalue:{type:"number"},flight_destid:{},flight_originid:{},flight_pagetype:{type:"enum",values:["home","searchresults","offerdetail","cart","purchase","cancel","other"]},flight_startdate:{type:"date"},flight_enddate:{type:"date"},flight_totalvalue:{type:"number"},affiliation:{},brs_response_id:{},checkout_option:{},checkout_step:{type:"integer"},content_id:{},content_type:{},coupon:{},currency:{type:"string_currency",beacon:"gc"},description:{},fatal:{},method:{},name:{},revenue_value:{type:"number",beacon:"gv"},screen_name:{},search_term:{},shipping:{type:"number"},tax:{type:"number"},transaction_id:{},rep:{},vid:{},tpp:{},gtm_tag_source:{},items:{type:"array"},"items.brand":{},"items.category":{},"items.creative_name":{},"items.creative_slot":{},"items.id":{},"items.list_name":{},"items.list_position":{type:"integer"},"items.location_id":{},"items.name":{},"items.price":{type:"number"},"items.quantity":{type:"number"},"items.variant":{},promotions:{type:"array"},"promotions.creative_name":{},"promotions.creative_slot":{},"promotions.id":{},"promotions.name":{},pid:{type:"object"},"pid.em":{type:"pid"},"pid.email":{type:"pid",beacon:"em"},"pid.ph":{type:"pid"},"pid.phone_number":{type:"pid",beacon:"ph"}},this.knownEvents={add_payment_info:[],add_to_cart:["revenue_value","currency","items"],add_to_wishlist:["revenue_value","currency","items"],begin_checkout:["revenue_value","currency","items","coupon"],checkout_progress:["revenue_value","currency","items","coupon","checkout_step","checkout_option"],exception:["description","fatal"],generate_lead:["revenue_value","currency","transaction_id"],login:["method"],page_view:["page_title","page_location","page_path","rep","tpp","gtm_tag_source","pid"],purchase:["transaction_id","revenue_value","currency","tax","shipping","items","coupon"],refund:["transaction_id","revenue_value","currency","tax","shipping","items"],remove_from_cart:["revenue_value","currency","items"],screen_view:["screen_name"],search:["search_term"],select_content:["items","promotions","content_type","content_id"],set_checkout_option:["checkout_step","checkout_option"],share:["method","content_type","content_id"],sign_up:["method"],view_item:["items"],view_item_list:["items"],view_promotion:["promotions"],view_search_results:["search_term"]},this.pageLevelParams={},this.legacyValidPageLoadKeyNames={rep:1,pid:1},this.legacyValidCustomEventKeyNames={ec:1,el:1,ev:1,ea:1,gv:1,gc:1,prodid:1,pagetype:1},this.ambiguousValidCustomEventKeyNames={ecomm_prodid:1,ecomm_pagetype:1,rep:1,pid:1},this.validRetailPageTypeValues={home:1,searchresults:1,category:1,product:1,cart:1,purchase:1,other:1},this.invalidKeyException="Invalid data: Key Name: ",this.invalidEventException="Invalid event type: Event Type: ",this.invalidPageTypeException="Invalid pagetype value: ",this.invalidProdIdException="The prodid value must be within 1 to 50 characters.",this.missingPageTypeException="The pagetype parameter is required when you include the prodid parameter.",this.goalCurrencyFormatException="gc value must be ISO standard currency code",this.missingHotelParametersException="The hotel total price (hct_total_price) and currency parameters are required when you include other hotel parameters.",this.hotelVariableRevenueException="The variable revenue parameter (revenue_value) cannot be sent when you include other hotel parameters.",this.evq=v.q instanceof Array?v.q:[],this.evqDispatch=!1,this.pageLoadDispatch=!1,this.documentLoaded=!1,this.deferLoad=!1,this.eventPushQueue=[],(this.uetInstance=this).domainName=null,this.sessionCookieName="_uetsid",this.sessionExpirationTime=86400,this.visitorExpirationTime=33696e3,this.cookieIdMaxLength=36,this.insightsDataMaxLength=128,this.insightsCookieMaxLength=this.cookieIdMaxLength+1+this.insightsDataMaxLength,this.msClkIdCookieValuePrefix="_uet",this.msClkIdCookieName="_uetmsclkid",this.msClkIdParamName="msclkid",this.msClkIdExpirationTime=7776e3,this.lengthMsClkId=32,this.msClkId=null,this.subVersion=1,this.previousPage=null,this.snippetEventQueue=[],this.midOverride=!1,this.checkuetHostdocumentload=function(){var e,t=this.uetInstance;if(t.documentLoaded||!document.body||document.readyState&&"interactive"!==document.readyState&&"complete"!==document.readyState&&"loaded"!==document.readyState||t.deferLoad||(t.dispatchq(!0),t.documentLoaded=!0),t.documentLoaded)if(t.uetConfig.consent.enabled&&!t.uetConfig.consent.hasWaited&&0<t.uetConfig.consent.waitForUpdate)t.uetConfig.consent.hasWaited=!0,setTimeout(function(){t.checkuetHostdocumentload()},t.uetConfig.consent.waitForUpdate);else if(!t.uetConfig.tcf.enabled||t.uetConfig.tcf.hasLoaded||t.uetConfig.tcf.timeoutId){if(0<t.eventPushQueue.length){for(e=0;e<t.eventPushQueue.length;e++)t._push(t.eventPushQueue[e]);t.eventPushQueue=[]}}else t.uetConfig.tcf.timeoutId=setTimeout(function(){t.checkuetHostdocumentload()},500);else setTimeout(function(){t.checkuetHostdocumentload()},5)},this.tcfCallback=function(t,e){if(e&&(this.uetConfig.tcf.hasLoaded||(this.uetConfig.tcf.hasLoaded=!0,clearTimeout(this.uetConfig.tcf.timeoutId)),this.uetConfig.tcf.adStorageAllowed=void 0,this.uetConfig.tcf.measurementAllowed=void 0,this.uetConfig.tcf.personalizationAllowed=void 0,this.uetConfig.tcf.gdprApplies=t.gdprApplies,!1!==t.gdprApplies)){var i=function(e){return!0===t.purpose.consents[e]||!0===t.purpose.legitimateInterests[e]};!0!==t.vendor.consents[this.uetConfig.tcf.vendorId]&&!0!==t.vendor.legitimateInterests[this.uetConfig.tcf.vendorId]||(this.uetConfig.tcf.adStorageAllowed=i(1),this.uetConfig.tcf.measurementAllowed=i(7)&&i(9)&&i(10),this.uetConfig.tcf.personalizationAllowed=i(3)&&i(4)),this.uetConfig.tcf.adStorageAllowed?this.pageLoadDispatch&&this.addMsClkId(this.beaconParams):(delete this.beaconParams.sid,delete this.beaconParams.vid,delete this.beaconParams.msclkid)}},this.getClUrl=function(e){return!0===this.uetConfig.tcf.enabled&&!0===this.uetConfig.tcf.hasLoaded&&!0===this.uetConfig.tcf.gdprApplies&&!0!==this.uetConfig.tcf.adStorageAllowed?e.replace(this.domain,this.domainCl):e},this.isAdStorageAllowed=function(){return!(this.beaconParams.Ver<2||!1===this.uetConfig.cookieAllowed||!0===this.uetConfig.consent.enabled&&!1===this.uetConfig.consent.adStorageAllowed||!0===this.uetConfig.tcf.enabled&&!0===this.uetConfig.tcf.hasLoaded&&!0===this.uetConfig.tcf.gdprApplies&&!0!==this.uetConfig.tcf.adStorageAllowed)},this.trimTagId=function(e){1!==e.Ver&&(this.stringExists(e.tagId)&&!this.stringExists(e.ti)&&(e.ti=e.tagId),this.stringExists(e.ti)&&(e.ti=e.ti.replace(/^\s+|\s+$/g,"")))},this.isDuplicate=function(e){try{return!(!e||!e.q||"object"!=_typeof(e.q))&&(!(2!==e.Ver||!e.q.beaconParams||2!==e.q.beaconParams.Ver)&&!(!e.q.beaconParams.ti||e.ti!==e.q.beaconParams.ti))}catch(e){return!1}},this.loadConfig=function(){var e,t,i,o,n,s,a,r,h,d,c,p,u,l,g,m,f;for(a in!(this.uetConfig.cookieAllowed=!0)===v.storeConvTrackCookies&&(this.uetConfig.cookieAllowed=!1),this.uetConfig.cookieDomain="",v.hasOwnProperty("cookieDomain")&&v.cookieDomain&&"string"==typeof v.cookieDomain&&(this.uetConfig.cookieDomain=v.cookieDomain),this.uetConfig.cookieFlags="",v.hasOwnProperty("cookieFlags")&&v.cookieFlags&&"string"==typeof v.cookieFlags&&(this.uetConfig.cookieFlags=v.cookieFlags),!(this.uetConfig.navTimingApi=!1)===v.navTimingApi&&(this.uetConfig.navTimingApi=!0),this.uetConfig.errorBeaconLevel=0,v.hasOwnProperty("errorBeaconLevel")&&("number"==typeof(e=v.errorBeaconLevel)&&e%1==0&&0<=e&&e<=2&&(this.uetConfig.errorBeaconLevel=e)),!(this.uetConfig.disableAutoPageView=!1)===v.disableAutoPageView&&(this.uetConfig.disableAutoPageView=!0),!(this.uetConfig.disableVisibilityEvents=!1)===v.disableVisibilityEvents&&(this.uetConfig.disableVisibilityEvents=!0),!(this.uetConfig.removeQueryFromUrls=!1)===v.removeQueryFromUrls&&(this.uetConfig.removeQueryFromUrls=!0),!(this.uetConfig.allRep=!1)===v.allRep&&(this.uetConfig.allRep=!0),t="_uetmsdns",v.hasOwnProperty("msDnsCookie")&&v.msDnsCookie&&"string"==typeof v.msDnsCookie&&(t=v.msDnsCookie),this.uetConfig.msDns="1"===this.getCookie(t,"",1),!(this.uetConfig.disableUetVid=!1)===v.disableUetVid&&(this.uetConfig.disableUetVid=!0),this.uetConfig.vidCookie="_uetvid",this.uetConfig.uidCookie="_uetuid",v.hasOwnProperty("uidCookie")&&v.uidCookie&&"string"==typeof v.uidCookie&&(this.uetConfig.uidCookie=v.uidCookie),this.uetConfig.gtmTagSource=void 0,v.hasOwnProperty("gtmTagSource")&&v.gtmTagSource&&"string"==typeof v.gtmTagSource&&(this.uetConfig.gtmTagSource=v.gtmTagSource),this.uetConfig.gtagPid=!1,v.hasOwnProperty("pagePid")&&v.pagePid&&"object"==_typeof(v.pagePid)?this.pageLevelParams.pid=v.pagePid:v.hasOwnProperty("gtagPid")&&!0===v.gtagPid&&(this.uetConfig.gtagPid=!0),!(this.uetConfig.enableAutoSpaTracking=!1)===v.enableAutoSpaTracking&&(this.uetConfig.enableAutoSpaTracking=!0),!(this.uetConfig.disableContainer=!1)===v.disableContainer&&(this.uetConfig.disableContainer=!0),v.hasOwnProperty("alt")&&(this.uetConfig.imgAlt=v.alt),v.hasOwnProperty("clarityProjectId")&&v.clarityProjectId&&"string"==typeof v.clarityProjectId&&((p=document.createElement("script")).src="https://clarity.microsoft.com/js/"+v.clarityProjectId,p.type="text/javascript",p.setAttribute("crossorigin","anonymous"),p.async=1,p.onload=this.clarityOnLoad,document.head.appendChild(p)),void 0!==window.XMLHttpRequest&&"withCredentials"in new XMLHttpRequest&&(this.supportsCORS=!0),"undefined"!=typeof XDomainRequest&&(this.supportsXDR=!0),i="https:",this.uetConfig.dbgCookie="_uetdbg",o=this.getQueryParam(window.location.href,"bat_debug"),this.stringExists(o)&&(o.match(/^[0-9]{13}$/)||o.match(/^[0-9a-f]{8}-([0-9a-f]{4}-){3}[0-9a-f]{12}$/))?this.setCookie(this.uetConfig.dbgCookie,o,0,!0,!1,"",this.cookieIdMaxLength):o=this.getCookie(this.uetConfig.dbgCookie,"",this.cookieIdMaxLength),this.stringExists(o)&&(this.uetConfig.batDebug=o),n=0,1===v.Ver&&void 0!==v.advertiserId&&(n=v.advertiserId),this.postURL=i+"//"+this.domain+"/action/"+n,this.urlPrefix=this.postURL+"?",this.errPrefix=i+"//"+this.domain+"/action-err/"+n+"?",this.previewPrefix=i+"//"+this.domain+"/actionp/"+n+"?",s=1!==v.Ver?{ti:0,Ver:0,tm:1,Tag:0,EXT_Data:0}:{Ver:0,tagId:0,Tag:0,Sig:0,EXT_Data:0},v)s.hasOwnProperty(a)&&(this.beaconParams[a]=1===s[a]?encodeURIComponent(v[a]):v[a]);for(this.beaconParams.mid=this.getUuidV4(!0),r=void 0,h=0;h<5&&(r="ueto_"+this.makeRandomStr(10),window[r]);h++);this.stringExists(v.ti)&&(d=["56004448","5798164","20132024","4000835","4074038"],c=window.navigator.userLanguage||window.navigator.language,this.stringExists(c)&&0===c.indexOf("de")&&-1!==d.indexOf(v.ti)&&(this.uetConfig.deBlock=!0,this.uetConfig.cookieAllowed=!1));try{this.stringExists(r)&&!window[r]?window[r]=this.uetInstance:r=void 0}catch(p){}this.stringExists(v.ti)&&!this.uetConfig.disableContainer&&(p=document.createElement("script"),u=i+"//"+this.domain+"/p/action/"+v.ti+".js",this.stringExists(this.uetConfig.batDebug)&&(u+="?bat_debug="+this.uetConfig.batDebug),p.src=u,p.type="text/javascript",p.async=1,r&&p.setAttribute("data-ueto",r),document.head.appendChild(p)),navigator.userAgentData&&navigator.userAgentData.getHighEntropyValues&&"Windows"===navigator.userAgentData.platform&&(this.deferLoad=!0,l=this,g=setTimeout(function(){l.deferLoad=!1,l.fireSendBeacon("error",{msg:encodeURIComponent("Timeout requesting UA CH")})},50),navigator.userAgentData.getHighEntropyValues(["platformVersion"]).then(function(e){e.hasOwnProperty("platformVersion")&&(l.uetConfig.uach={},l.uetConfig.uach.pv=encodeURIComponent(e.platformVersion)),l.deferLoad=!1,clearTimeout(g)},function(e){l.deferLoad=!1,clearTimeout(g),l.fireSendBeacon("error",{msg:encodeURIComponent("Error requesting UA CH: "+e)})})),this.stringExists(this.uetConfig.batDebug)&&window.opener&&this.stringExists(v.ti)&&(m="https://ui.ads.microsoft.com",document.referrer&&window.URL&&("https:"===(f=new URL(document.referrer)).protocol&&/\.microsoft\.com$/.test(f.hostname)&&(m=f.origin)),window.opener.postMessage({type:"AckBatDbgMode",tagId:v.ti},m))},this.makeRandomStr=function(e){for(var t="",i=0;i<Math.ceil(e/2);i++)t+=this._SB(Math.floor(256*Math.random()));return t.slice(-e)},this.push=function(){var e,t,i=arguments,o=!1;if(1===i.length)if(e="event",i[0]===this.pageLoadEvt)t=[this.pageViewEvt,{}],o=!0;else{if(i[0]instanceof Array){if(!(0<i[0].length))return;i[0]=i[0][0]}t=["",i[0]||{}],o=!0}else{if(!(1<i.length&&i[0]!==this.pageLoadEvt))return;e=i[0],t=Array.prototype.slice.call(i,1)}this.uetInstance.documentLoaded||"set"===e||"consent"===e||"config"===e?this.uetInstance._push([e,t,o]):this.uetInstance.eventPushQueue.push([e,t,o])},this._push=function(e){var t,i,o,n,s,a,r,h;if(e[1]instanceof Array)if("event"===e[0]){if(t=e[1][1]||{},null==(i=e[1][0]))return;o=i===this.pageViewEvt?this.pageLoadEvt:this.customEvt,this.evt(o,i,t,e[2])}else if("set"===e[0]){if("object"!=_typeof(e[1][0]))return;for(n in e[1][0])this.knownParams.hasOwnProperty(n)&&(this.pageLevelParams[n]=e[1][0][n],"pid"===n&&!0===this.pageLoadDispatch&&((s=this.validateSubparams({pid:e[1][0][n]},"")).hasOwnProperty("pid")&&this.firePidEvent(s.pid)))}else if("consent"===e[0]){if(this.uetConfig.consent.enabled=!0,r=e[1][1],h=e[1][0],null===r||"object"!=_typeof(r))return;"default"===h?(r.hasOwnProperty("ad_storage")&&!1===this.uetConfig.consent.adStorageUpdated&&(this.uetConfig.consent.adStorageAllowed="denied"!==r.ad_storage),r.hasOwnProperty("wait_for_update")&&(a=parseInt(r.wait_for_update,10),!isNaN(a)&&0<a&&(a=Math.min(a,1e4),this.uetConfig.consent.waitForUpdate=a))):"update"===h&&r.hasOwnProperty("ad_storage")&&(this.uetConfig.consent.adStorageAllowed="denied"!==r.ad_storage,this.uetConfig.consent.adStorageUpdated=!0,this.uetConfig.consent.adStorageAllowed?this.pageLoadDispatch&&this.addMsClkId(this.beaconParams):(delete this.beaconParams.sid,delete this.beaconParams.vid,delete this.beaconParams.msclkid))}else if("config"===e[0]){if(r=e[1][1],h=e[1][0],null===r||"object"!=_typeof(r))return;"tcf"===h&&r.hasOwnProperty("enabled")&&!0===r.enabled&&"function"==typeof __tcfapi&&(this.uetConfig.tcf.enabled=!0,window.__tcfapi("addEventListener",2,this.tcfCallback.bind(this)))}},this.dispatchq=function(e){var t,i,o,n,s,a,r;for((e||(!(this.evqDispatch=!0)===this.uetConfig.disableVisibilityEvents&&"onpagehide"in window&&(window.addEventListener("pageshow",this.firePageShow.bind(this)),window.addEventListener("pagehide",this.firePageHide.bind(this))),!0===this.uetConfig.enableAutoSpaTracking&&("onpopstate"in window&&window.addEventListener("popstate",this.documentUrlChanged.bind(this,"popstate")),this.wrapHistoryMethod("pushState"),this.wrapHistoryMethod("replaceState"))),o=0);o<this.evq.length;o++)if("object"==_typeof(this.evq[o])){if(n=this.evq[o],"set"===t)e&&this.push(t,n);else if("consent"===t||"config"===t)e&&void 0!==i&&this.push(t,i,n);else if(!e)if("event"===t){for(a in s=!1,this.legacyValidCustomEventKeyNames)if(n.hasOwnProperty(a)){s=!0;break}void 0!==i&&(this.push(t,i,s?{}:n),s&&this.push(n))}else this.push(n);t=i=void 0}else"string"==typeof this.evq[o]||this.evq[o]instanceof String?(void 0!==t&&void 0!==i&&(e||this.push(t,i,{}),t=i=void 0),r=this.evq[o],void 0!==t||"set"!==r&&"consent"!==r&&"config"!==r&&"event"!==r?void 0!==t&&void 0===i?i=r:t=i=void 0:t=r,o!==this.evq.length-1||"event"!==t||e||void 0===i||this.push(t,i,{})):t=i=void 0},this.invisibleDiv=null,this.invisibleFrame=null,this._SB=function(e){return(e+256).toString(16).substring(1,3)},this._SU=function(e,t){for(var i="",o=0;o<16;o++)t&&4<=o&&o<=10&&o%2==0&&(i+="-"),i+=this._SB(e[o]);return i},this.getRandomValues=window.crypto&&window.crypto.getRandomValues&&window.crypto.getRandomValues.bind(window.crypto)||window.msCrypto&&window.msCrypto.getRandomValues&&window.msCrypto.getRandomValues.bind(window.msCrypto)||function(e){for(var t=0;t<e.length;t++)e[t]=Math.floor(256*Math.random())},this.getUuidV1=function(e){var t,i,o,n;try{for(t=new Uint8Array(10),this.getRandomValues(t),i=1e4*(Date.now()+122192928e5)+(t[8]+(t[9]<<8))%1e4,(o=new Uint8Array(16))[3]=255&i,o[2]=i>>8&255,o[1]=i>>16&255,o[0]=i>>24&255,i/=4294967296,o[5]=255&i,o[4]=i>>8&255,o[7]=i>>16&255,o[6]=i>>24&255,n=0;n<8;n++)o[n+8]=t[n];return o[8]&=63,o[8]|=128,o[6]&=15,o[6]|=16,o[10]|=1,this._SU(o,e)}catch(e){return""}},this.getUuidV4=function(e){try{var t=new Uint8Array(16);return this.getRandomValues(t),t[8]&=63,t[8]|=128,t[6]&=15,t[6]|=64,this._SU(t,e)}catch(e){return""}},this.stringifyToRequest=function(e,t){var i,o="",n="";for(i in t&&(n=t+"."),e)o+="object"==_typeof(e[i])?this.stringifyToRequest(e[i],n+i):n+i+"="+e[i]+"&";return o},this.createInvisibleElement=function(e,t){var i=document.createElement(t);return i.style.width="0px",i.style.height="0px",i.style.display="none",i.style.visibility="hidden",i.id="batBeacon"+Math.floor(1e12*Math.random()),e.appendChild(i),i},this.createInvisibleDiv=function(e){return this.invisibleDiv=this.createInvisibleElement(e,"div"),this.invisibleDiv.id},this.fireBeaconImg=function(e){var t,i,o=this.createInvisibleElement(this.invisibleDiv,"img");return o.width=0,o.height=0,i=e+"&rn="+(t=Math.floor(1e6*Math.random())),o.setAttribute("alt",""),this.uetConfig.imgAlt&&o.setAttribute("alt",this.uetConfig.imgAlt),o.setAttribute("src",i),t},this.addLoadTime=function(e){var t,i,o,n;if(window.performance&&(t=window.performance.timing.domContentLoadedEventEnd,window.performance.timing.loadEventEnd&&(t=window.performance.timing.loadEventEnd),void 0!==t&&0!==t&&(i=t-window.performance.timing.navigationStart,e.lt=i),this.uetConfig.navTimingApi&&null!=window.performance.timing)){var s=["navigationStart","unloadEventStart","unloadEventEnd","redirectStart","redirectEnd","fetchStart","domainLookupStart","domainLookupEnd","connectStart","connectEnd","secureConnectionStart","requestStart","responseStart","responseEnd","domLoading","domInteractive","domContentLoadedEventStart","domContentLoadedEventEnd","domComplete","loadEventStart","loadEventEnd"],a=window.performance.timing[s[0]],r=a;for(o=1;o<s.length;o++)r+=",",r+=null==(n=window.performance.timing[s[o]])||0===n?"":n-a;r.length<=150&&(e.pt=r),null!=window.performance.navigation&&(e.pn=window.performance.navigation.type+","+window.performance.navigation.redirectCount)}return e},this.hashCode=function(e){var t,i=0;if(0===e.length)return i;for(t=0;t<e.length;t++)i=(i<<5)-i+e.charCodeAt(t),i&=i;return i},this.addPluginData=function(e){for(var t,i,o,n=[],s=0;s<window.navigator.plugins.length;s++)n.push({name:window.navigator.plugins[s].name});for(t=n.sort(function(e,t){return e.name>t.name?1:e.name<t.name?-1:0}),i="",o=0;o<t.length;o++)i+=t[o].name;return e.pi=this.hashCode(i),e},this.addFraudSignals=function(e){return screen&&(screen.width&&(e.sw=screen.width),screen.height&&(e.sh=screen.height),screen.colorDepth&&(e.sc=screen.colorDepth)),navigator&&!0===navigator.webdriver&&(e.nwd="1"),e},this.addUrlData=function(e,t){var i,o,n,s,a,r,h;if(t=!0===t,i=!1,window.window!=window.top)try{for(o=0,n=window.window;o<=5&&null!=n&&n!=window.top;o++,n=n.parent)if(null!=n.document&&this.stringExists(n.document.referrer)&&"about:blank"!==n.document.referrer.toLowerCase()){a=n.document.referrer,!0!==this.uetConfig.removeQueryFromUrls&&!t||(a=a.split("?")[0]),e.p=encodeURIComponent(a),i=!(e.r="");break}}catch(e){}return i||(s=window.document.referrer,a=window.location.href,!0!==this.uetConfig.removeQueryFromUrls&&!t||(a=a.split("?")[0],s=s.split("?")[0]),r=window.location.hash,h=0<=a.indexOf(r)?a:a+r,e.p=encodeURIComponent(h),e.r=encodeURIComponent(s)),t&&delete e.r,e},this.extractMsClkId=function(e){if(!this.stringExists(this.msClkId)){var t=e.p;try{t=decodeURIComponent(t)}catch(e){}this.msClkId=this.getQueryParam(t,this.msClkIdParamName)}},this.addPageData=function(e,t){var i,o,n;return t=!0===t,e=this.addPluginData(e),i=window.navigator.userLanguage||window.navigator.language,this.stringExists(i)&&(e.lg=i),e=this.addFraudSignals(e),o=window.document.title,this.stringExists(o)&&!this.stringExists(e.tl)&&(e.tl=encodeURIComponent(o).replace(/%2C/gi,",")),window.document.head.getElementsByTagName("meta").keywords&&(n=window.document.head.getElementsByTagName("meta").keywords.content,this.stringExists(n)&&(e.kw=encodeURIComponent(n).replace(/%2C/gi,","))),t?this.stringExists(this.previousPage)&&!e.hasOwnProperty("r")&&(e.r=this.previousPage):(e=this.addUrlData(e),e=this.addLoadTime(e)),navigator.maxTouchPoints&&(e.mtp=navigator.maxTouchPoints),e},this.removeTrailingAmp=function(e){var t=e.charAt(e.length-1);return"&"!==t&&"?"!==t||(e=e.substring(0,e.length-1)),e},this.helperError=function(e){if("function"==typeof CustomEvent){var t={errMsg:e,tagId:this.beaconParams.ti},i=new CustomEvent("uetError",{detail:t});window.dispatchEvent(i)}},this.throwError=function(e){if(this.helperError(e),0<this.uetConfig.errorBeaconLevel){this.invisibleDiv||this.createInvisibleDiv(document.body);var t=this.combine(this.beaconParams,{errMsg:encodeURIComponent(e)}),i=this.stringifyToRequest(t),o=this.removeTrailingAmp(this.getClUrl(this.errPrefix)+i);this.fireBeaconImg(o)}throw e},this.validateValue=function(e,t,i,o){var n=0,s=t,a=void 0===i||0===i;return-1!==t.toString().indexOf(",")&&(s=t.replace(/,/g,"")),n=parseFloat(s),(isNaN(s)||isNaN(n)||a&&-1!==n.toString().indexOf("."))&&this.throwError(e+" should be "+(a?"an integer":"a number")),o<n?this.throwError(e+" cannot be greater than "+o):n<0?this.throwError(e+" cannot be less than 0"):this.getDecimalPlaces(n)>i&&(n=parseFloat(n.toFixed(i))),n},this.validateRegex=function(e,t,i){var o=null==e?"":e.toString();return o.match(t)||this.throwError(i),o},this.encodeParameter=function(e){return(null==e?"":e.toString()).replace(/&/gi,"%26").replace(/#/gi,"%23")},this._validateProdId=function(e){return null==e&&this.throwError(this.invalidProdIdException),((e=e.toString()).length<1||50<e.length)&&this.throwError(this.invalidProdIdException),e},this.validateProdId=function(e){var t,i="";if(e instanceof Array){for(t=0;t<e.length;t++)e[t]instanceof Array&&this.throwError(this.invalidProdIdException),null!==e[t]&&void 0!==e[t]&&(i+=""!==i?",":"",i+=encodeURIComponent(this._validateProdId(e[t])));""===i&&this.throwError(this.invalidProdIdException)}else i=encodeURIComponent(this._validateProdId(e));return i},this.validatePageType=function(e,t){null==e&&this.throwError(this.invalidPageTypeException+e);var i=e.toString().toLowerCase();return t[i]||this.throwError(this.invalidPageTypeException+i),i},this.getDecimalPlaces=function(e){var t,i=parseFloat(e);return isNaN(e)||isNaN(i)?0:(t=(""+e).match(/(?:\.(\d+))?(?:[eE]([+-]?\d+))?$/))?Math.max(0,(t[1]?t[1].length:0)-(t[2]?+t[2]:0)):0},this.sha256=function e(t){function i(e,t){return e>>>t|e<<32-t}var o,n,s;try{for(var a,r,h=Math.pow,d=h(2,32),c="length",p="",u=[],l=8*t[c],g=e.h=e.h||[],m=e.k=e.k||[],f=m[c],v={},y=2;f<64;y++)if(!v[y]){for(a=0;a<313;a+=y)v[a]=y;g[f]=h(y,.5)*d|0,m[f++]=h(y,1/3)*d|0}for(t+="";t[c]%64-56;)t+="\0";for(a=0;a<t[c];a++)u[a>>2]|=t.charCodeAt(a)<<(3-a)%4*8;for(u.push(l/d|0),u.push(0|l);u[c];){for(o=u.splice(0,16),g=(n=g).slice(0,8),a=0;a<64;a++){var w=o[a-15],C=o[a-2],_=g[0],b=g[4],P=g[7]+(i(b,6)^i(b,11)^i(b,25))+(b&g[5]^~b&g[6])+m[a]+(o[a]=a<16?o[a]:o[a-16]+(i(w,7)^i(w,18)^w>>>3)+o[a-7]+(i(C,17)^i(C,19)^C>>>10)|0);(g=[P+((i(_,2)^i(_,13)^i(_,22))+(_&g[1]^_&g[2]^g[1]&g[2]))|0].concat(g))[4]=g[4]+P|0}for(a=0;a<8;a++)g[a]=g[a]+n[a]|0}for(a=0;a<8;a++)for(r=24;0<=r;r-=8)p+=((s=g[a]>>r&255)<16?"0":"")+s.toString(16);return p}catch(r){return""}},this.validatePid=function(e,t){var i,o;if(""===(e=e.trim().toLowerCase()))return"";if(!e.match(/^[a-z0-9]{64}$/))switch(t){case"em":case"email":if(2!=(i=e.split("@")).length){e="";break}i[0]=i[0].trim(),-1!=(o=i[0].indexOf("+"))&&(i[0]=i[0].substring(0,o)),i[0]=i[0].replace(/\./g,""),i[1]=i[1].trim(),e=i[0]+"@"+i[1],e=this.sha256(e);break;case"ph":case"phone_number":if("+"!==(e=e.replace(/[-() \t]/g,"")).charAt(0)&&(e="+"+e),!e.match(/^\+\d{11,15}$/)){e="";break}e=this.sha256(e);break;default:e=""}return e},this.validateParameter=function(e,t,i){var o,n;if(t.match(/^[a-z_]{2,32}$/)||this.throwError(e+" invalid parameter name"),null==i.type||null==this.paramValidations[i.type])return e.toString();switch((o=this.paramValidations[i.type]).type){case"regex":n=o.error.replace("{p}",t),e=this.validateRegex(e,o.regex,n);break;case"num":e=this.validateValue(t,e,o.digits,o.max);break;case"enum":""!==(e=e.toString().toLowerCase())&&-1===i.values.indexOf(e)&&this.throwError(o.error.replace("{p}",t));break;case"pid":e=e.toString(),e=this.validatePid(e,t);break;case"array":e instanceof Array&&!(e.length<1)||this.throwError(o.error.replace("{p}",t)),e=this.validateParameterArray(e,t);break;case"object":e="object"!=_typeof(e)?(this.helperError(o.error.replace("{p}",t)),""):this.validateParameterObject(e,t);break;default:e=e.toString()}return e},this.validateParameterObject=function(e,t){return e=this.validateSubparams(e,t+"."),this.removeTrailingAmp(this.stringifyToRequest(e))},this.validateParameterArray=function(e,t){for(var i=0;i<e.length;i++)"object"==_typeof(e[i])&&(e[i]=this.validateParameterObject(e[i],t));return e.join(",")},this.validateSubparams=function(e,t){var i,o,n,s={};for(i in e)if(this.knownParams.hasOwnProperty(t+i)&&null!=e[i]){if(o=this.knownParams[t+i],"string"==typeof(n=this.validateParameter(e[i],i,o))||n instanceof String){if(""===n)continue;n=encodeURIComponent(n)}s[o.hasOwnProperty("beacon")?o.beacon:i]=n}return s},this.eventBasicChecks=function(e,t){e||this.throwError(this.invalidEventException+"undefined event."),e!==this.pageLoadEvt&&e!==this.customEvt&&this.throwError(this.invalidEventException+e),t||this.throwError("undefined data object passed to validate"),_typeof(t)},this.validateDataObjectNew=function(e,t){var i,o,n,s,a;if(this.eventBasicChecks(e,t),!t.hasOwnProperty("ecomm_prodid")||null==t.ecomm_prodid||"string"==typeof t.ecomm_prodid&&""===t.ecomm_prodid.toString()||(t.ecomm_prodid=this.validateProdId(t.ecomm_prodid)),null!=(i=t.event_action)&&this.knownEvents.hasOwnProperty(i))for(n in o=this.knownEvents[i])s=o[n],this.pageLevelParams.hasOwnProperty(s)&&!t.hasOwnProperty(s)&&(t[s]=this.pageLevelParams[s]);return!(a=this.validateSubparams(t,"")).hasOwnProperty("pagetype")&&a.hasOwnProperty("prodid")&&this.throwError(this.missingPageTypeException),a.hasOwnProperty("pagetype")&&"purchase"===a.pagetype&&a.hasOwnProperty("ea")&&"purchase"===a.ea&&a.hasOwnProperty("ecomm_totalvalue")&&!a.hasOwnProperty("gv")&&(a.gv=a.ecomm_totalvalue),(a.hasOwnProperty("hct_base_price")||a.hasOwnProperty("hct_booking_xref")||a.hasOwnProperty("hct_pagetype")||a.hasOwnProperty("hct_checkin_date")||a.hasOwnProperty("hct_checkout_date")||a.hasOwnProperty("hct_length_of_stay")||a.hasOwnProperty("hct_partner_hotel_id"))&&(a.hasOwnProperty("hct_total_price")&&a.hasOwnProperty("gc")||this.throwError(this.missingHotelParametersException)),a.hasOwnProperty("hct_total_price")&&a.hasOwnProperty("gv")&&this.throwError(this.hotelVariableRevenueException),a},this.validateDataObject=function(e,t){var i,o,n,s;for(i in this.eventBasicChecks(e,t),t)e===this.customEvt&&(this.legacyValidCustomEventKeyNames[i]||this.ambiguousValidCustomEventKeyNames[i])||e===this.pageLoadEvt&&this.legacyValidPageLoadKeyNames[i]||this.throwError(this.invalidKeyException+i);t.hasOwnProperty("pid")&&(t.pid=this.validateParameter(t.pid,"pid",this.knownParams.pid),""===t.pid?delete t.pid:t.pid=encodeURIComponent(t.pid)),0<t.hasOwnProperty("ev")&&(t.ev=this.validateValue("ev",t.ev,3,999999999999)),0<t.hasOwnProperty("gv")&&(t.gv=this.validateValue("gv",t.gv,3,999999999999)),0<t.hasOwnProperty("gc")&&(t.gc=this.validateRegex(t.gc,/^[a-zA-Z]{3}$/,this.goalCurrencyFormatException)),0<t.hasOwnProperty("ec")&&null!==t.ec&&void 0!==t.ec&&(o=encodeURIComponent(t.ec),t.ec=this.encodeParameter(t.ec),t.ec!==o&&(t.ec2=o)),0<t.hasOwnProperty("ea")&&null!==t.ea&&void 0!==t.ea&&(n=encodeURIComponent(t.ea),t.ea=this.encodeParameter(t.ea),t.ea!==n&&(t.ea2=n)),0<t.hasOwnProperty("el")&&null!==t.el&&void 0!==t.el&&(s=encodeURIComponent(t.el),t.el=this.encodeParameter(t.el),t.el!==s&&(t.el2=s)),0<t.hasOwnProperty("ecomm_prodid")&&(t.prodid=t.ecomm_prodid,delete t.ecomm_prodid),0<t.hasOwnProperty("ecomm_pagetype")&&(t.pagetype=t.ecomm_pagetype,delete t.ecomm_pagetype),!t.hasOwnProperty("pagetype")||null!=t.pagetype&&""!==t.pagetype.toString()||delete t.pagetype,t.hasOwnProperty("prodid")&&(null==t.prodid||"string"==typeof t.prodid&&""===t.prodid)&&delete t.prodid,0<t.hasOwnProperty("pagetype")?(t.pagetype=this.validatePageType(t.pagetype,this.validRetailPageTypeValues),0<t.hasOwnProperty("prodid")&&(t.prodid=this.validateProdId(t.prodid))):0<t.hasOwnProperty("prodid")&&this.throwError(this.missingPageTypeException)},this.evt=function(e,t,i,o){var n,s,a,r,h,d,c,p,u,l,g,m;if(o=!1!==o,i=i||{},!0===this.uetConfig.disableAutoPageView&&!1===this.evqDispatch&&this.dispatchq(!1),"object"==_typeof(i)){if(!0===this.uetConfig.allRep?i.rep="1":i.hasOwnProperty("rep")&&(1===i.rep||"1"===i.rep||!0===i.rep?i.rep="1":delete i.rep),e===this.pageLoadEvt&&(!0===this.uetConfig.gtagPid&&"enhanced_conversion_data"in window&&"object"==("undefined"==typeof enhanced_conversion_data?"undefined":_typeof(enhanced_conversion_data))&&(this.pageLevelParams.pid={em:window.enhanced_conversion_data.email,ph:window.enhanced_conversion_data.phone_number}),o&&this.pageLevelParams.hasOwnProperty("pid")&&!i.hasOwnProperty("pid")&&(i.pid=this.pageLevelParams.pid)),this.pageLevelParams.hasOwnProperty("pid")&&(this.knownEvents[t]=this.knownEvents[t]||[],-1===this.knownEvents[t].indexOf("pid")&&this.knownEvents[t].push("pid")),o?this.validateDataObject(e,i):(i.event_action=t,e===this.customEvt&&i.hasOwnProperty("gtm_tag_source")&&(i=this.mapGtmParams(i)),i=this.validateDataObjectNew(e,i)),e===this.customEvt){for(s in n=[],i)n.push(s);if(0===n.length)return;o||(i.en="Y"),i=this.addUrlData(i,!0),i=this.addFraudSignals(i)}else if(e===this.pageLoadEvt){if(null!=i.ea&&this.knownEvents.hasOwnProperty(i.ea))for(r in a=this.knownEvents[i.ea],i)-1===a.indexOf(r)&&delete i[r];if(h=!o&&i.hasOwnProperty("page_path")){if(!(i.spa="Y")===this.pageLoadDispatch?(d={},d=this.addPageData(d,!1),this.stringExists(d.p)&&(this.previousPage=d.p),i.r=d.r,i.lt=d.lt,d.hasOwnProperty("pt")&&(i.pt=d.pt),d.hasOwnProperty("pn")&&(i.pn=d.pn)):(this.firePageHide(),this.midOverride||(this.beaconParams.mid=this.getUuidV4(!0))),i.hasOwnProperty("page_title")&&(i.tl=i.page_title,delete i.page_title),this.stringExists(this.previousPage)){if(-1===(p=(c=this.previousPage.toUpperCase()).indexOf("%3A%2F%2F")))return;"%2F"===i.page_path.substring(0,3).toUpperCase()?(p+=9,u=c.indexOf("%2F",p),i.p=-1===u?this.previousPage+i.page_path:this.previousPage.substring(0,u)+i.page_path):i.p=this.previousPage}}else{if(!0===this.pageLoadDispatch)return;if(!0===this.uetConfig.disableAutoPageView&&o)return;this.stringExists(this.uetConfig.gtmTagSource)&&(i.gtm_tag_source=this.uetConfig.gtmTagSource)}this.uetConfig.uach&&(l=this.stringifyToRequest(this.uetConfig.uach),l=this.removeTrailingAmp(l),l=encodeURIComponent(l),i.uach=l),!1===this.pageLoadDispatch&&(this.pageLoadDispatch=!0),i=this.addPageData(i,h),this.stringExists(i.p)&&(this.previousPage=i.p)}this.invisibleDiv||this.createInvisibleDiv(document.body),i.evt=e,window.window!=window.top&&(i.ifm=1),this.addCookieId(this.beaconParams,"sid","",this.sessionCookieName,this.sessionExpirationTime),this.addCookieId(this.beaconParams,"uid","",this.uetConfig.uidCookie,0),this.pageLevelParams.hasOwnProperty("vid")?"string"==typeof(g=this.pageLevelParams.vid)&&this.stringExists(g)&&((g=g.replace(/[-{}]/g,"").toLowerCase()).match(/^[0-9a-f]{32}$/)&&(this.beaconParams.vid=g,this.beaconParams.vids="3")):this.uetConfig.disableUetVid||this.addCookieId(this.beaconParams,"vid","vids",this.uetConfig.vidCookie,this.uetConfig.disableUetVid?0:this.visitorExpirationTime),this.addMsClkId(this.beaconParams),e===this.pageLoadEvt&&(i.sv=this.subVersion),!0===this.uetConfig.consent.enabled&&(i.asc=this.uetConfig.consent.adStorageAllowed?"G":"D"),!0===this.uetConfig.tcf.enabled&&(m={st:!0===this.uetConfig.tcf.hasLoaded?"L":"E"},!0===this.uetConfig.tcf.gdprApplies&&(m.gdpr="Y",!0===this.uetConfig.tcf.adStorageAllowed&&(m.as="G"),!0===this.uetConfig.tcf.measurementAllowed&&(m.ms="G"),!0===this.uetConfig.tcf.personalizationAllowed&&(m.pz="G")),i.tcf=encodeURIComponent(this.removeTrailingAmp(this.stringifyToRequest(m)))),!0===this.midOverride&&(i.et="up"),this.stringExists(this.uetConfig.batDebug)&&(i.dbg=this.uetConfig.batDebug),!0!==this.uetConfig.msDns&&(this.fireBeacon(i),i.abf=!0),e===this.pageLoadEvt&&i.hasOwnProperty("pid")&&this.firePidEvent(i.pid),e===this.pageLoadEvt&&!1===this.evqDispatch&&this.dispatchq(!1)}},this.removeLocalStorageBackup=function(e){try{localStorage.removeItem(e+"_exp"),localStorage.removeItem(e)}catch(e){}},this.setLocalStorageBackup=function(e,t,i){try{var o=new Date;o.setTime(o.getTime()+1e3*i),localStorage.setItem(e,t),localStorage.setItem(e+"_exp",o.toUTCString())}catch(e){}},this.getLocalStorageBackup=function(e,t){var i,o;try{return null==(i=localStorage.getItem(e+"_exp"))?null:new Date>new Date(i)?(this.removeLocalStorageBackup(e),null):null==(o=localStorage.getItem(e))||o.length>t?null:o}catch(e){return null}},this.getCookie=function(e,t,i){var o,n,s,a,r;if(!this.stringExists(e)||0===(o=document.cookie).length)return null;for(this.stringExists(t)||(t=""),s=0;s<o.length;){if((n=o.indexOf(e+"="+t,s))<0)return null;if(!(0<n&&" "!==o[n-1]&&";"!==o[n-1]))break;s=n+e.length+1}return a=0<=(a=o.indexOf(";",n))?a:o.length,(r=o.substring(n+e.length+1+t.length,a)).length>i?null:r},this._setCookie=function(e,t,i,o,n){return document.cookie=e+"="+t+(i?";expires="+i.toUTCString():"")+(o?";domain=."+o:"")+";path=/"+(this.stringExists(n)?";"+n:"")},this.getHostname=function(){return document.location&&document.location.hostname},this.setCookie=function(e,t,i,o,n,s,a){var r,h,d,c,p;if(!this.stringExists(e)||(this.stringExists(s)||(s=""),!this.stringExists(t)||t.length>a))return null;if(r=null,0<i&&(r=new Date).setTime(r.getTime()+1e3*i),(h=new Date).setTime(0),n&&null!=r&&this.setLocalStorageBackup(e,t,i),null===this.domainName||o){if((d=this.getHostname())&&"string"==typeof d&&"localhost"!==d)for(p=(c=d.split(".")).pop(),3===c.length&&0<=Number(p)&&(c=[]);0<c.length;)if(p=c.pop()+"."+p,(""===this.uetConfig.cookieDomain||this.uetConfig.cookieDomain.toLowerCase()===p.toLowerCase())&&(o&&(this._setCookie(e,"",h,p,this.uetConfig.cookieFlags),o=!!this.getCookie(e,s,a)),!o&&(this._setCookie(e,s+t,r,p,this.uetConfig.cookieFlags),this.getCookie(e,s,a))))return void(this.domainName=p);this.domainName=""}this._setCookie(e,s+t,r,this.domainName,this.uetConfig.cookieFlags)},this.getQueryParam=function(e,t){return this.stringExists(e)&&this.stringExists(t)&&!/[^\d\w]/.exec(t)?(new RegExp("[?&]"+t+"=([^&#]*)","i").exec(e)||[,null])[1]:null},this.addCookieId=function(e,t,i,o,n){var s,a;if(!this.isAdStorageAllowed())return e;var r="2",h=!0,d=this.getCookie(o,"",this.insightsCookieMaxLength);return this.stringExists(d)||(h=!1,d=this.getLocalStorageBackup(o,this.insightsCookieMaxLength)),s=this.insightsTrimCookie(d,!0),d=this.insightsTrimCookie(d,!1),0===n?this.stringExists(d)&&(e[t]=encodeURIComponent(d),this.stringExists(i)&&(e[i]=r)):(this.stringExists(d)&&!d.match(/^[0-9a-f]{32}$/)&&(d=d.replace(/-/g,"")),r=this.stringExists(d)&&d.match(/^[0-9a-f]{32}$/)?"0":(d=this.getUuidV1(!1),"1"),a=null===s?d:d+"|"+s,this.setCookie(o,a,n,h,!0,"",this.insightsCookieMaxLength),this.getCookie(o,"",this.insightsCookieMaxLength)!==a&&this.getLocalStorageBackup(o,this.insightsCookieMaxLength)!==a||(e[t]=encodeURIComponent(d),this.stringExists(i)&&(e[i]=r))),e},this.addMsClkId=function(e){if(!this.isAdStorageAllowed())return e;this.extractMsClkId(this.addUrlData({}));var t="0",i=this.getCookie(this.msClkIdCookieName,this.msClkIdCookieValuePrefix,this.lengthMsClkId);return this.stringExists(i)||(i=this.getLocalStorageBackup(this.msClkIdCookieName,this.lengthMsClkId)),this.stringExists(this.msClkId)?i!==this.msClkId&&(t="1"):this.msClkId=i,this.stringExists(this.msClkId)?(this.setCookie(this.msClkIdCookieName,this.msClkId,this.msClkIdExpirationTime,!0,!0,this.msClkIdCookieValuePrefix,this.lengthMsClkId),this.getCookie(this.msClkIdCookieName,this.msClkIdCookieValuePrefix,this.lengthMsClkId)!==this.msClkId&&(t+="N"),e.msclkid=encodeURIComponent(this.msClkId+"-"+t)):e.msclkid="N",e},this.clone=function(e,t){for(var i in void 0===t&&(t={}),e)e.hasOwnProperty(i)&&(t[i]=e[i]);return t},this.combine=function(e,t){var i=this.clone(e);return i.alt&&delete i.alt,this.clone(t,i)},this.fireBeacon=function(e){for(var t,i,o=this.getClUrl(this.urlPrefix),n=this.combine(this.beaconParams,e),s=this.stringifyToRequest(n),a=this.removeTrailingAmp(o+s),r=["r","el2","ec2","ea2","page_location","page_path","kw","p","tl","items"],h=0;encodeURI(a).length>this.URLLENGTHLIMIT&&h<r.length;h++)(t=r[h])in n&&(0==h?n[t]=n[t].split("?")[0]:h<=3?n[t]="":delete n[t],s=this.stringifyToRequest(n),a=this.removeTrailingAmp(o+s));this.fireBeaconImg(a),this.snippetEventQueue.push(s),20<this.snippetEventQueue.length&&this.snippetEventQueue.shift();try{"function"==typeof CustomEvent&&(i=new CustomEvent("UetEvent",{bubbles:!0,detail:{uetEvent:s}}),this.invisibleDiv.dispatchEvent(i))}catch(e){}},this.firePageShow=function(e){!1===this.uetConfig.disableVisibilityEvents&&e&&e.persisted&&this.fireSendBeacon("pageShow")},this.firePageHide=function(){!1===this.uetConfig.disableVisibilityEvents&&this.fireSendBeacon("pageHide")},this.firePidEvent=function(e){var t=this.combine(this.beaconParams,{evt:"pid",pid:e}),i=this.removeTrailingAmp(this.getClUrl(this.urlPrefix)+this.stringifyToRequest(t));this.invisibleDiv||this.createInvisibleDiv(document.body),this.fireBeaconImg(i)},this.fireSendBeacon=function(e,t){var i,o=this.combine(this.beaconParams,{evt:e});t&&(o=this.clone(t,o)),i=this.removeTrailingAmp(this.getClUrl(this.previewPrefix)+this.stringifyToRequest(o));try{navigator.sendBeacon?navigator.sendBeacon(i):this.fireBeaconImg(i)}catch(e){}},this.clarityOnLoad=function(){"undefined"!=typeof clarity&&window.clarity.start()},this.mapGtmUasProducts=function(e){var t,i,o;if(e.hasOwnProperty("ecomm_totalvalue")){if(e.ecomm_pagetype="purchase",e.ecomm_prodid=[],e.items=[],e.hasOwnProperty("transactionProducts")&&e.transactionProducts instanceof Array)for(t=0;t<e.transactionProducts.length;t++)"object"==_typeof(i=e.transactionProducts[t])&&(o={},i.hasOwnProperty("sku")&&(o.id=i.sku,e.ecomm_prodid.push(o.id)),i.hasOwnProperty("price")&&(o.price=i.price),i.hasOwnProperty("quantity")&&(o.quantity=i.quantity),e.items.push(o));delete e.transactionProducts}},this.mapGtmEcommercePurchase=function(e){var t,i,o,n;if(e.hasOwnProperty("ecommerce")&&"object"==_typeof(e.ecommerce)){if(e.ecommerce.hasOwnProperty("ecommerce")&&"object"==_typeof(e.ecommerce.ecommerce)&&(e.ecommerce=e.ecommerce.ecommerce),e.ecommerce.hasOwnProperty("purchase")&&"object"==_typeof(e.ecommerce.purchase))t=e.ecommerce.purchase,e.ecomm_pagetype="purchase";else if(e.ecommerce.hasOwnProperty("add")&&"object"==_typeof(e.ecommerce.add))t=e.ecommerce.add,e.ecomm_pagetype="cart";else if(e.ecommerce.hasOwnProperty("click")&&"object"==_typeof(e.ecommerce.click))t=e.ecommerce.click,e.ecomm_pagetype="product";else if(e.ecommerce.hasOwnProperty("detail")&&"object"==_typeof(e.ecommerce.detail))t=e.ecommerce.detail,e.ecomm_pagetype="product";else{if(!(e.ecommerce.hasOwnProperty("impressions")&&e.ecommerce.impressions instanceof Array))return void delete e.ecommerce;t={products:e.ecommerce.impressions},e.ecomm_pagetype="other"}if(e.ecommerce.hasOwnProperty("currencyCode")&&(e.currency=e.ecommerce.currencyCode),t.hasOwnProperty("actionField")&&"object"==_typeof(t.actionField)&&(t.actionField.hasOwnProperty("id")&&(e.transaction_id=t.actionField.id),t.actionField.hasOwnProperty("revenue")&&(e.ecomm_totalvalue=t.actionField.revenue)),t.hasOwnProperty("products")&&t.products instanceof Array)for(e.ecomm_prodid=[],e.items=[],i=0;i<t.products.length;i++)"object"==_typeof(o=t.products[i])&&(n={},o.hasOwnProperty("id")&&(n.id=o.id,e.ecomm_prodid.push(n.id)),o.hasOwnProperty("price")&&(n.price=o.price),o.hasOwnProperty("quantity")&&(n.quantity=o.quantity),e.items.push(n));delete e.ecommerce}},this.mapGtmGa4Items=function(e){var t,i,o,n;if(e.hasOwnProperty("event_action"))switch(e.event_action){case"purchase":e.ecomm_pagetype="purchase";break;case"add_to_cart":e.ecomm_pagetype="cart";break;case"view_item_list":e.ecomm_pagetype="category";break;case"view_item":case"select_item":e.ecomm_pagetype="product"}if(e.hasOwnProperty("ecomm_pagetype")&&e.hasOwnProperty("event_value")&&(e.ecomm_totalvalue=e.event_value),e.hasOwnProperty("items")&&e.items instanceof Array){for(e.ecomm_prodid=[],t=[],i=0;i<e.items.length;i++)"object"==_typeof(o=e.items[i])&&(n={},(o.item_id||o.id)&&(n.id=o.item_id||o.id,e.ecomm_prodid.push(n.id)),o.hasOwnProperty("price")&&(n.price=o.price),o.hasOwnProperty("quantity")&&(n.quantity=o.quantity),t.push(n));e.items=t}},this.replaceGtmParam=function(e,t,i){e.hasOwnProperty(t)&&(e[i]=e[t],delete e[t])},this.mapGtmParams=function(e){switch(e.hasOwnProperty("event_value")&&""===e.event_value&&delete e.event_value,e.gtm_tag_source){case"ua_s":this.replaceGtmParam(e,"transactionId","transaction_id"),this.replaceGtmParam(e,"transactionTotal","ecomm_totalvalue"),this.mapGtmUasProducts(e);break;case"ua_e":this.mapGtmEcommercePurchase(e);break;case"ga4":this.replaceGtmParam(e,"value","event_value"),this.mapGtmGa4Items(e)}return e};var i=window.location.href;this.documentUrlChanged=function(){var e,t=window.location.href;i!=t&&(i=t,e=window.location.pathname+window.location.search+window.location.hash,this.push("event","page_view",{page_path:e}))},this.wrapHistoryMethod=function(e){if(window.history&&window.history[e]){var t=window.history[e],i=this.documentUrlChanged.bind(this,e);window.history[e]=function(){var e=t.apply(window.history,arguments);try{i()}catch(e){}return e}}},this.insightsTrimCookie=function(e,t){if(!this.stringExists(e))return null;var i=e.indexOf("|");return-1===i?t?null:e:t?e.substring(i+1):e.substring(0,i)},this.insightsGetCookie=function(e){if(!this.isAdStorageAllowed())return null;var t=0===e?this.sessionCookieName:this.uetConfig.vidCookie,i=this.getCookie(t,"",this.insightsCookieMaxLength);return this.stringExists(i)||(i=this.getLocalStorageBackup(t,this.insightsCookieMaxLength)),this.insightsTrimCookie(i,!0)},this.insightsSetCookie=function(e,t){var i;if(this.isAdStorageAllowed()&&this.stringExists(e)&&!(e.length>this.insightsDataMaxLength)){var o=0===t?this.sessionCookieName:this.uetConfig.vidCookie,n=!0,s=this.getCookie(o,"",this.insightsCookieMaxLength);this.stringExists(s)||(n=!1,s=this.getLocalStorageBackup(o,this.insightsCookieMaxLength)),this.stringExists(s)||(s=""),i=this.insightsTrimCookie(s,!1)+"|"+e,this.setCookie(o,i,0===t?this.sessionExpirationTime:this.visitorExpirationTime,n,!0,"",this.insightsCookieMaxLength)}},this.setExternalMid=function(e){this.stringExists(e)&&e.match(/^[0-9a-fA-F]{8}-?([0-9a-fA-F]{4}-?){3}[0-9a-fA-F]{12}$/)&&(this.beaconParams.mid=e,this.midOverride=!0)},this.trimTagId(v),this.isDuplicate(v)?(this.uetInstance=v.q,navigator.sendBeacon&&this.uetInstance.fireSendBeacon("dedup")):(this.loadConfig(),this.checkuetHostdocumentload())}function UET_init(e,t){"object"==_typeof(window[e])&&"[object Array]"!==Object.prototype.toString.call(window[e])||(t.q=window[e],window[e]=new UET(t))}function UET_push(e){var t=Array.prototype.slice.call(arguments,1);window[e]=window[e]||[],window[e].push.apply(window[e],t)}
//# sourceMappingURL=bat.min.js.map
